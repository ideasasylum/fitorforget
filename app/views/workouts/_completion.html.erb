<div class="bg-white rounded-lg shadow-md p-8">
  <div class="text-center mb-8">
    <h1 class="text-4xl font-extrabold text-gray-900 mb-4">Workout Complete! ðŸŽ‰</h1>

    <% stats = @workout.completion_stats %>
    <p class="text-xl text-gray-700 mb-4">
      You completed <%= stats[:completed_count] %> of <%= stats[:total_count] %> exercises
      <% if stats[:skipped_count] > 0 %>
        <span class="text-gray-500">(skipped <%= stats[:skipped_count] %>)</span>
      <% end %>
    </p>

    <% if @workout.completed_at %>
      <p class="text-sm text-gray-500">
        Completed at <%= @workout.completed_at.strftime("%B %d, %Y at %I:%M %p") %>
      </p>
    <% end %>
  </div>

  <!-- Exercise List -->
  <div class="mb-8">
    <h2 class="text-lg font-semibold text-gray-900 mb-4">Exercise Summary</h2>
    <div class="space-y-2">
      <% @workout.exercises_data.each_with_index do |exercise, index| %>
        <%= link_to workout_path(@workout, exercise_index: index), class: "block p-4 rounded-lg border border-gray-200 hover:border-indigo-300 hover:bg-indigo-50 transition-colors" do %>
          <div class="flex items-center justify-between">
            <div class="flex-1">
              <h3 class="font-medium text-gray-900"><%= exercise['name'] %></h3>
              <p class="text-sm text-gray-600"><%= exercise['repeat_count'] %> reps</p>
            </div>
            <div class="ml-4">
              <% if exercise['completed'] %>
                <span class="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-green-100 text-green-800">
                  <svg class="w-4 h-4 mr-1" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/>
                  </svg>
                  Completed
                </span>
              <% elsif exercise['skipped'] %>
                <span class="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-gray-100 text-gray-800">
                  Skipped
                </span>
              <% else %>
                <span class="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-yellow-100 text-yellow-800">
                  Not Done
                </span>
              <% end %>
            </div>
          </div>
        <% end %>
      <% end %>
    </div>
  </div>

  <div class="flex flex-col sm:flex-row gap-4 justify-center">
    <%= link_to "View Your Workouts", workouts_path, class: "inline-flex items-center justify-center px-6 py-3 border border-transparent text-base font-medium rounded-lg text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-colors min-h-[44px]" %>
    <%= link_to "Browse Programs", programs_path, class: "inline-flex items-center justify-center px-6 py-3 border border-gray-300 text-base font-medium rounded-lg text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-colors min-h-[44px]" %>
  </div>
</div>

<% if flash[:notice] == "Workout complete! ðŸŽ‰" %>
  <script type="module">
    import confetti from 'canvas-confetti';

    // Trigger confetti animation
    confetti({
      particleCount: 100,
      spread: 70,
      origin: { y: 0.6 }
    });

    // Additional burst after a short delay
    setTimeout(() => {
      confetti({
        particleCount: 50,
        angle: 60,
        spread: 55,
        origin: { x: 0 }
      });
    }, 250);

    setTimeout(() => {
      confetti({
        particleCount: 50,
        angle: 120,
        spread: 55,
        origin: { x: 1 }
      });
    }, 400);
  </script>
<% end %>
